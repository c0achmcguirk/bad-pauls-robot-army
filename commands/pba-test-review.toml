description = "Analyze test coverage and create a testing improvement plan"
prompt = """
First, activate the 'pba-workspace-tools' skill to ensure you have the correct tool mappings for this environment.

Using the pba-test-automator skill, prepare a testing review report. Analyze the test coverage and testing practices in the codebase and create a comprehensive plan WITHOUT making any changes.

## Tool Configuration

**IMPORTANT**: Consult the pba-workspace-tools skill for your organization's configured tools.
Use ONLY the tools listed in the Active Configuration section of pba-workspace-tools.
If a capability is not configured, inform the user and continue with available capabilities.

## Input Parsing
The user invoked: /pba-test-review {{args}}

Valid scopes:
- **No argument**: Analyze the entire project
- **File/directory path**: Scope analysis to that specific path
- **"current changes"**: Analyze uncommitted changes (use source_control `status` and `diff_uncommitted` capabilities)
- **"recent changes"**: Analyze recent commits (use source_control `log` capability)
- **Change request reference**: Analyze a specific PR/CL (use change_requests `view` and `diff` capabilities)

## Your Task
1. First, understand the current testing setup and coverage
2. Identify gaps in test coverage and testing practices
3. Create a prioritized testing improvement plan
4. Save your plan as a markdown file in the /reports directory

## Analysis Steps
1. **Test Coverage Assessment**
   - Measure current test coverage
   - Identify untested code paths
   - Review test quality
   - Check for test types (unit, integration, e2e)
   - Analyze test maintainability

2. **Testing Gaps Analysis**
   - Critical functionality without tests
   - Edge cases not covered
   - Error scenarios untested
   - Missing integration tests
   - Absent performance tests

3. **Testing Practice Review**
   - Test organization
   - Naming conventions
   - Mock/stub usage
   - Test data management
   - CI/CD integration

## Output Format
Create a markdown file at `/reports/test-review-{scope}-{timestamp}.md` with:

```markdown
# Testing Review Plan
Generated: {timestamp}
Scope: {full_path_or_entire_project}

## Executive Summary
Brief overview of testing state and key findings

## Current Testing Status
### Coverage Metrics
- Overall coverage: X%
- Unit test coverage: Y%
- Integration test coverage: Z%
- Critical paths covered: N%

### Test Distribution
- Unit tests: X
- Integration tests: Y
- E2E tests: Z
- Performance tests: N

## Testing Gaps
### Critical Gaps (Untested Core Features)
- Feature/Function X: No tests
- Critical path Y: Partial coverage

### High Priority Gaps
- Error handling: Module X
- Edge cases: Function Y

### Medium Priority Gaps
- Integration: Between A and B
- Performance: Component C

## Test Quality Issues
### Test Maintenance Problems
- Brittle tests in X
- Outdated tests in Y
- Flaky tests in Z

### Test Design Issues
- Over-mocking in tests for A
- Unclear test names in B
- Missing assertions in C

## Testing Improvement Plan
### Phase 1: Critical Coverage
1. Add tests for critical feature X
2. Cover error paths in module Y
3. Create integration tests for Z

### Phase 2: Comprehensive Coverage
1. Increase unit test coverage to 80%
2. Add edge case tests
3. Implement E2E test suite

### Phase 3: Quality Improvements
1. Refactor brittle tests
2. Standardize test structure
3. Improve test documentation

## Test Strategy Recommendations
### Testing Pyramid
- Unit Tests: 70%
- Integration Tests: 20%
- E2E Tests: 10%

### Best Practices to Implement
- Test naming standards
- Test data factories
- Continuous test review
- Coverage monitoring

## Tooling Recommendations
- Coverage tools: [Suggestions]
- Test runners: [Suggestions]
- Mocking libraries: [Suggestions]
```

Remember: DO NOT make any changes. Only analyze and report.

## CRITICAL: Report Generation

**YOU MUST CREATE THE REPORT FILE.** This is not optional.

1. Create the report file using the Write tool
2. Fill in ALL sections with real findings
3. Provide the full path to the user when done
"""
